pipeline {
agent {docker(maven:3.3.9)}
node {
  git url: 'https://github.com/jglick/simple-maven-project-with-tests.git'
  def mvnHome = tool 'M3'
  sh "${mvnHome}/bin/mvn -B verify"
}
     stages  {
           stage ("compile stage"){
           steps{
                 withMaven (maven :'Maven_3.3.9'){
                 sh 'mvn clean compile'
                 }
               }
               
           stage ("Testing stage"){
               withMaven (maven :'Maven_3.3.9'){
                 sh 'mvn test '
                 }
               }
           
            stage ("Deployment stage"){
               withMaven (maven :'Maven_3.3.9'){
                 sh 'mvn deploy '
                 }
               }
             }
          }
}
